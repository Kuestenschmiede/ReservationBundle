function getWeekdate(e){var t,i,r;return 0<e.indexOf(".")?e=(t=e.split("."))[2]+"/"+(i=(i=t[1])<10?"0"+i:i)+"/"+(r=(r=t[0])<10?"0"+r:r):0<e.indexOf("/")&&(e=(t=e.split("/"))[2]+"/"+(i=(i=t[1])<10?"0"+i:i)+"/"+(r=(r=t[0])<10?"0"+r:r)),new Date(e).getDay()}function isSunday(e,t){return 0===getWeekdate(e)}function isMonday(e,t){return 1===getWeekdate(e)}function isTuesday(e,t){return 2===getWeekdate(e)}function isWednesday(e,t){return 3===getWeekdate(e)}function isThursday(e,t){return 4===getWeekdate(e)}function isFriday(e,t){return 5===getWeekdate(e)}function isSaturday(e,t){return 6===getWeekdate(e)}function setObjectId(e,t,i=0){var r,n=(n=e.className).split(" ")[0],a=t,l=document.getElementById("c4g_reservation_object_"+a),d=jQuery(document.getElementsByClassName("displayReservationObjects")),t="";return l&&(jQuery(l).show(),d&&d.show(),n&&(r=(t=n.split("_")[2]).split("-"),jQuery(e).is(":disabled")||jQuery(l).val(r[0]).change(),t=r||t)),hideOptions(d,a,t,i),!0}function hideOptions(e,t,r,n){if(e){-1==t&&(t=(v=document.getElementById("c4g_reservation_type"))?v.value:-1);var a=document.getElementById("c4g_reservation_object_"+t),l=-1,d=0;if(a){for(i=0;i<a.options.length;i++){var s=a.options[i],o=s.getAttribute("min")?parseInt(s.getAttribute("min")):1,u=s.getAttribute("max")?parseInt(s.getAttribute("max")):1,c=document.getElementById("c4g_desiredCapacity_"+t),c=c?c.value:1,y=!1;if(jQuery.isArray(r)){for(j=0;j<r.length;j++)if(r[j]==s.value){0==j&&(d=r[j]),y=!0;break}}else 0<=parseInt(r)&&r==s.value&&(d=r,y=!0);y||-1==s.value?-1!=s.value&&(jQuery(a).children('option[value="'+s.value+'"]').removeAttr("disabled"),o&&u&&c&&0<c&&(c<o||u<c)?jQuery(a).children('option[value="'+s.value+'"]').attr("disabled","disabled"):(jQuery(a).children('option[value="'+s.value+'"]').removeAttr("disabled"),0<=d&&s.value==d?l=d:-1==l&&-1!=s.value&&(l=s.value))):jQuery(a).children('option[value="'+s.value+'"]').attr("disabled","disabled")}if(0<=parseInt(l)){if(jQuery(a).val(l).change(),jQuery(a).children('option[value="'+l+'"]').removeAttr("disabled"),jQuery(a).children('option[value="-1"]').attr("disabled","disabled"),jQuery(a).removeAttr("disabled"),n){var v=jQuery(a).children('option[value="'+l+'"]').text(),h="",g="",m=document.getElementsByClassName("c4g_date_field_input");if(m)for(i=0;i<m.length;i++){var f=m[i];if(f&&f.value&&jQuery(f).is(":visible")){h=f.value;break}}var p=jQuery(".reservation_time_button_"+t+' input[type = "radio"]:checked');if(p)for(i=0;i<p.length;i++){var _=p[i];_&&(g=(_=jQuery('label[for="'+jQuery(_).attr("id")+'"]'))?_[0].firstChild.nodeValue:"")}v&&""!=h&&""!=g&&(-1!=(n=v.lastIndexOf(" ("))&&(v=v.substr(0,n)),jQuery(a).children('option[value="'+l+'"]').text(v+" ("+h+" "+g+")"))}}else jQuery(a).children('option[value="-1"]').removeAttr("disabled"),jQuery(a).val("-1").change(),jQuery(a).prop("disabled",!0)}}checkEventFields()}function checkType(e,t){return t?!!jQuery(e).parent().parent().hasClass("begindate-event"):!!jQuery(e).parent().parent().hasClass("begin-date")}function setReservationForm(e,t,r,n,a){var l;jQuery(document.getElementsByClassName("reservation-id")).hide(),-1==t&&(t=(l=document.getElementById("c4g_reservation_type"))?l.value:-1,a||(d=l.selectedIndex,(d=l.options[d])&&(a=2==d.getAttribute("type"))));var d="c4g_beginDate_"+t;if(document.getElementById(d))setTimeset(document.getElementById(d),e,t,r,n);else if(a){n=window.location.search;const u=new URLSearchParams(n);n=u.get("event");if(n){d="c4g_beginDateEvent_"+t+"-22"+n;document.getElementById(d)&&checkEventFields()}else{var s=document.getElementsByClassName("c4g_date_field_input");if(s)for(i=0;i<s.length;i++){var o=s[i];if(o&&checkType(o,a)&&o.value){o=o.id;if(o&&o.indexOf("c4g_beginDateEvent_"+t+"-22")){checkEventFields();break}}}}}}function checkTimelist(n,a){var l=-1;if(n&&a)for(idx=0;idx<a.length;idx++)if(a[idx]){let e=[],t=a[idx].toString();t&&t.indexOf("#")?e=t.split("#"):e[0]=t;let i=[];(n=n.toString()).indexOf("#")?i=n.split("#"):i[0]=n;let r=0;if(parseInt(e[0])===parseInt(i[0])&&(l=idx,r++),e[1]&&i[1]){var d=parseInt(e[0]),s=d+parseInt(e[1]),o=parseInt(i[0]),u=o+parseInt(i[1]);if(d<=o&&o<s&&(l=idx,r++),d<u&&u<=s&&(l=idx,r++),3==r)break}}else if(1==hits)break;return l}function checkMax(n,a,l,d,s,e){let o=!0;var u,c,j,v;if(n[a][l].act+parseInt(e)<=n[a][l].max){for(y=0;y<n.length;y++)if(d&&s&&y!=a){let e=[],t=s[y].toString();t&&t.indexOf("#")?e=t.split("#"):e[0]=t;let i=[];(d=d.toString()).indexOf("#")?i=d.split("#"):i[0]=d;let r=!1;if(parseInt(e[0])===parseInt(i[0])?r=!0:e[1]&&i[1]&&(c=(u=parseInt(e[0]))+parseInt(e[1]),v=(j=parseInt(i[0]))+parseInt(i[1]),(u<=j&&j<c||u<v&&v<=c)&&(r=!0)),r)for(z=0;z<n[y].length;z++)if(n[y][z].act>=n[y][z].max||n[y][z].act+n[a][l].act>=n[a][l].max)return!1;o=!0}}else o=!1;return o}function shuffle(e){let t=e.length;for(;0<t;){var i=Math.floor(Math.random()*t);t--;var r=e[t];e[t]=e[i],e[i]=r}return e}function setTimeset(e,t,S,r,D){var n=apiBaseUrl+"/c4g_brick_ajax",F=0,z=-1;-1==S?(jQuery(document.getElementsByClassName("reservation_time_button"))&&jQuery(document.getElementsByClassName("reservation_time_button")).hide(),jQuery(document.getElementsByClassName("displayReservationObjects"))&&jQuery(document.getElementsByClassName("displayReservationObjects")).hide()):(e=e||document.getElementById("c4g_beginDate_"+S),F=e?e.value:0);var a,e=document.getElementById("c4g_duration");e&&(a=e.value),C4GCallOnChangeMethodswitchFunction(document.getElementById("c4g_reservation_object_"+S)),C4GCallOnChange(document.getElementById("c4g_reservation_object_"+S)),F&&F.indexOf("/")&&(F=(F=F.replace("/","~")).replace("/","~")),t&&r&&F&&S&&(a=a||-1,jQuery.ajax({dataType:"json",url:n+"/"+t+"/buttonclick:"+r+":"+F+":"+S+":"+a+"?id=0",success:function(e){var t=document.getElementById("c4g_beginTime_"+S+"-00"+getWeekdate(F)),n=(t?t.parentElement:document).getElementsByClassName("c4g_brick_radio_group"),a=[],d=[],s=[],r=e.times;r.length;document.getElementById("c4g_reservation_id").value=e.reservationId,jQuery(document.getElementsByClassName("reservation-id")).show(),jQuery(document.getElementsByClassName("reservation_time_button_"+S))&&jQuery(document.getElementsByClassName("reservation_time_button_"+S)).show();var o,u=0;for(o in r){var c=r[o].time;0<parseInt(r[o].interval)&&(c=r[o].time+"#"+r[o].interval);var y=r[o].interval,v=r[o].objects;a[u]=c,d[u]=y,s[u]=v,u++}var h=document.getElementById("c4g_reservation_object_"+S),g=1,m=1;if(h)for(i=0;i<h.options.length;i++){var f=h.options[i],p=f.getAttribute("min")?parseInt(f.getAttribute("min")):1;(-1==p||p<g)&&(g=p);f=f.getAttribute("max")?parseInt(f.getAttribute("max")):1;(-1==f||m<f)&&(m=f)}var e=document.getElementById("c4g_desiredCapacity_"+S),_=e?e.value:1;if(n)for(i=0;i<n.length;i++)for(j=0;j<n[i].children.length;j++)if(!n[i].children[j].style||"display:none"!=n[i].children[j].style)for(k=0;k<n[i].children[j].children.length;k++){var b=jQuery(n[i].children[j].children[k]).val();if(b){namefield=n[i].children[j].children[k].getAttribute("name").substr(1);var Q=checkTimelist(b,a),I=-1,E=0;if(-1!==Q)for(l=0;l<s[Q].length;l++)-1!=s[Q][l].id&&checkMax(s,Q,l,b,a,_)&&(I=I<s[Q][l].act?s[Q][l].act:I,E=s[Q][l].percent);if(0<=I&&I<m&&g<=_&&_<=m){let e="",t=!1,r=[];for(l=0;l<s[Q].length;l++){var B=s[Q][l];if(B.priority&&1==B.priority){t=!0;break}}for(s[Q]=shuffle(s[Q]),l=0;l<s[Q].length;l++){var C=s[Q][l];d[Q],a[Q];t&&C.priority&&1==C.priority?r.splice(0,0,C.id):r.push(C.id);for(var x=0;x<jQuery(h).length;x++)if(h[x].value==C.id){if(t&&C.priority&&1==C.priority){z=C.id;break}if(!t){z=C.id;break}}}for(l=0;l<r.length;l++)0==l?e+=r[l]:e=e+"-"+r[l];jQuery(n[i].children[j].children[k]).removeClass().addClass("radio_object_"+e),jQuery(n[i].children[j].children[k]).attr("disabled",!1),0<E&&jQuery(n[i].children[j].children[k]).addClass("radio_object_hurry_up"),z&&-1!=z||(z=r[0]),hideOptions(w,S,e,D)}else jQuery(n[i].children[j].children[k]).removeClass().addClass("radio_object_disabled"),jQuery(n[i].children[j].children[k]).attr("disabled",!0)}}var w=document.getElementsByClassName("displayReservationObjects");if(-1!=S){var O=jQuery(".reservation_time_button_"+S+'.formdata input[type = "hidden"]'),A=!1;if(O)for(i=0;i<O.length;i++)if("none"!=O[i].style.display){A=O[i].value;break}var N=!1,T=jQuery(".reservation_time_button_"+S+' input[type = "radio"]');if(A){if(T)for(i=0;i<T.length;i++){var W=T[i];if(W&&jQuery(W).is(":visible")&&W.value===A){N=W;break}}}else T&&1===T.length&&(N=T[0]);!N||jQuery(N).is(":disabled")||jQuery(N).hasClass("radio_object_disabled")||(T.prop("checked",!0),e=N.getAttribute("name").substr(1),(e=document.getElementById(e))&&(e.value=N.value),setObjectId(N,S,D))}}})),!S||(a=jQuery(".reservation_time_button_"+S+' input[type = "radio"]'))&&1===a.length&&a[0].is(":visible")&&a.click()}function checkEventFields(){var e=document.getElementById("c4g_reservation_type"),t=e?e.value:-1,r=jQuery(".reservation-event-object select");if(jQuery(".eventdata").hide(),r&&r.is(":visible")){for(jQuery(document.getElementsByClassName("reservation-id")).show(),i=0;i<r.length;i++)if(r[i]){var n,a,l=-1;if(r[i].value&&(l=t.toString()+"-22"+r[i].value.toString(),jQuery(".eventdata_"+l).show(),jQuery(".eventdata_"+l).children().show()),n=document.getElementsByClassName("begindate-event"))for(j=0;j<n.length;j++)-1!=l&&jQuery(n[j]).children().children("input").hasClass("c4g_beginDateEvent_"+l)?(jQuery(n[j]).show(),jQuery(n[j]).children("label").show(),jQuery(n[j]).children(".c4g_date_field_container").show(),jQuery(n[j]).children(".c4g_date_field_container").children("input").show()):(jQuery(n[j]).hide(),jQuery(n[j]).children("label").hide(),jQuery(n[j]).children(".c4g_date_field_container").hide(),jQuery(n[j]).children(".c4g_date_field_container").children("input").hide());if(a=jQuery(".c4g_brick_radio_group_wrapper .reservation_time_event_button"))for(j=0;j<a.length;j++)-1!=l&&jQuery(a[j]).hasClass("reservation_time_event_button_"+l)?(jQuery(a[j]).show(),jQuery(a[j]).children("label").show(),jQuery(a[j]).parent().show(),jQuery(a[j]).parent().parent().show(),jQuery(a[j]).parent().parent().parent().show()):(jQuery(a[j]).hide(),jQuery(a[j]).children("label").hide(),jQuery(a[j]).parent().hide(),jQuery(a[j]).parent().parent().hide(),jQuery(a[j]).parent().parent().parent().hide())}}else{if(n=jQuery(".begindate-event"))for(i=0;i<n.length;i++)jQuery(n[i]).hide();if(a=jQuery(".reservation_time_event_button"))for(i=0;i<a.length;i++)jQuery(a[i]).hide()}}