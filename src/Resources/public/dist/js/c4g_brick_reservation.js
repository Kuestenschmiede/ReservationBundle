var callFromChangeCapacity=!1;function setObjectId(e,t,n=0){var a=!!e&&e.getAttribute("data-object"),r=document.getElementById("c4g_reservation_object_"+t),l=document.getElementsByClassName("displayReservationObjects"),s="",d=!1;if(r){if(r.style.display="block",d=r.value&&0<parseInt(r.value)?r.value:d,l)for(i=0;i<l.length;i++)l[i].style.display="block";if(a){var o=a.split("-"),c=!1;for(i=0;i<o.length;i++){for(j=0;j<r.options.length;j++)if(!r.options[j].getAttribute("hidden")&&r.options[j].value==o[i]){r.value=o[i],handleBrickConditions(),c=!0;break}if(c)break}s=o||s}}if(hideOptions(t,s,n),e&&(a=e.getAttribute("data-desc"))&&(t=e.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector(".c4g__form-description"))&&(t.innerHTML=a),d)for(i=0;i<r.options.length;i++)if(!r.options[i].getAttribute("hidden")&&!r.options[i].getAttribute("disabled")&&r.options[i].value==d){r.value=d,handleBrickConditions();break}if(r&&-1!==parseInt(r.value))for(i=0;i<r.options.length;i++)if(-1==parseInt(r.options[i].value)&&"none"!=r.options[i].style.display){r.options[i].style.display="none";break}return!0}function hideOptions(e,t,n){-1==e&&(e=(a=document.getElementById("c4g_reservation_type"))?a.value:-1);var a,r=document.getElementById("c4g_reservation_object_"+e),l=!1,s=0,d=!1;if(r){for(i=0;i<r.options.length;i++){var o=r.options[i],c=o.getAttribute("min")?parseInt(o.getAttribute("min")):1,u=o.getAttribute("max")?parseInt(o.getAttribute("max")):0,m=document.getElementById("c4g_desiredCapacity_"+e),m=m?m.value:0,g=(o.value&&-1==parseInt(o.value)&&(d=i),!1);if(Array.isArray(t)){if(c&&m&&0<m&&c<=m&&m<=u)for(j=0;j<t.length;j++)t[j]==o.value&&(s=t[j],g=!0);else for(j=0;j<t.length;j++)if(t[j]==o.value){0==j&&(s=t[j]),g=!0;break}}else 0<=parseInt(t)&&t==o.value&&(s=t,g=!0);if(g||-1==o.value?-1!=o.value&&(o.removeAttribute("disabled"),o.removeAttribute("hidden"),c&&m&&0<m?m<c||u&&u<m?(o.setAttribute("disabled","disabled"),o.setAttribute("hidden","hidden")):(o.removeAttribute("disabled"),o.removeAttribute("hidden"),(0<=s&&o.value==s||-1==l&&-1!=o.value)&&(l=i)):(o.removeAttribute("disabled"),o.removeAttribute("hidden"),(0<=s&&o.value==s||-1==r.value&&-1!=o.value)&&(l=i))):(o.setAttribute("disabled","disabled"),o.setAttribute("hidden","hidden")),n&&-1!=o.value&&g){var c=o.textContent,v="",p="",b=document.querySelectorAll(".reservation_time_button_"+e+' input[type = "radio"]:checked');if(b&&b[0]){for(var _=b[0].getAttribute("data-stamp")?parseInt(b[0].getAttribute("data-stamp")):0,y=document.getElementsByClassName("c4g__form-check-label"),f=0;f<y.length;f++)if(y[f].htmlFor==b[0].id){p=y[f].textContent;break}var h,A,I=document.querySelectorAll(".c4g__form-date-container .c4g_beginDate_"+e);if(I)for(f=0;f<I.length;f++){var E=I[f];if(E&&E.value){var B,N,x=E.getAttribute("data-org");null!==x&&(E.value=x),82800<=_?((x=new Date(E.value.replace(/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1"))).setSeconds(x.getSeconds()+86400),B=new Intl.DateTimeFormat("en",{year:"numeric"}).format(x),N=new Intl.DateTimeFormat("en",{month:"2-digit"}).format(x),v=new Intl.DateTimeFormat("en",{day:"2-digit"}).format(x)+"."+N+"."+B,E.setAttribute("data-org",E.value),E.value=v):v=E.value;break}}c&&""!=v&&""!=p&&(u=c.lastIndexOf(")"),m="",-1!=(h=c.lastIndexOf(" ("))&&-1!=u&&h<u&&(m=-1!==(A=c.indexOf(";"))?c.substr(h+2,A-h-2):c.substr(h+2,u-h-2)),-1!=h&&(c=c.substr(0,h)),-1!=p.indexOf(v)?m&&-1!==m.search(/€/)?o.textContent=c+" ("+m+"; "+p+")":o.textContent=c+" ("+p+")":m&&-1!==m.search(/€/)?o.textContent=c+" ("+m+"; "+v+" "+p+")":o.textContent=c+" ("+v+" "+p+")")}}}-1!==parseInt(l)&&r.options[l]?(r.value=r.options[l].value,r.options[l].removeAttribute("disabled"),r.options[l].removeAttribute("hidden"),0!=d&&(r.options[d].setAttribute("disabled","disabled"),r.options[d].setAttribute("hidden","hidden")),r.removeAttribute("disabled")):(0!=d&&(r.options[d].removeAttribute("disabled"),r.options[d].removeAttribute("hidden")),r.value=-1,r.setAttribute("disabled","disabled")),eventFire(r,"change")}checkEventFields()}function checkType(e,t){return t?!!e.parent.parent.classList.contains("begindate-event"):!!e.parent.parent.classList.contains("begin-date")}function setReservationForm(t,i){callFromChangeCapacity=!1,document.getElementsByClassName("reservation-id")[0]&&(document.getElementsByClassName("reservation-id")[0].style.display="none");var n=!1,a=!1,r=document.getElementById("c4g_reservation_type");if(r){t=r.value||-1;r=r.options[r.selectedIndex];if(r&&(n=2==r.getAttribute("type"),a=3==r.getAttribute("type")),0<t){var r=document.getElementById("c4g_desiredCapacity_"+t),r=(r&&(e=r.value,r.getAttribute("max")&&e>parseInt(r.getAttribute("max"))&&(r.value=r.getAttribute("max")),r.getAttribute("min"))&&e<parseInt(r.getAttribute("min"))&&(r.value=r.getAttribute("min")),document.getElementById("c4g_duration_"+t)),e=(r&&"none"!==r.style.display&&(r.style.display="block",e=r.value,r&&r.getAttribute("max")&&e>parseInt(r.getAttribute("max"))&&(r.value=r.getAttribute("max")),r)&&r.getAttribute("min")&&e<parseInt(r.getAttribute("min"))&&(r.value=r.getAttribute("min")),"c4g_beginDate_"+t);if(a){r=document.getElementById("c4g_reservation_object_"+t);r&&(e=e+"-33"+r.value,document.getElementById(e))&&setTimeset(document.getElementById(e).value,t,i,r.value)}else if(n){var a=window.location.search;let e=new URLSearchParams(a).get("event");if(e||-1!==(a=(r=window.location.pathname.split("/")).indexOf("event"))&&r[a+1]&&(e=r[a+1].replace(".html","")),e){r=document.getElementById("c4g_reservation_object_event_"+t),a=(r&&(r.value=e),"c4g_beginDateEvent_"+t+"-22"+e);document.getElementById(a)&&(setTimeset(document.getElementById(a).value,t,i,0),checkEventFields())}else{var l=document.getElementsByClassName("c4g__form-date-input");if(l)for(var s=0;s<l.length;s++){var d=l[s];if(d&&checkType(d,n)&&d.value){var o=d.id;if(o&&-1!==o.indexOf("c4g_beginDateEvent_"+t+"-22")){setTimeset(d.value,t,i,0),checkEventFields();break}}}}}else document.getElementById(e)&&setTimeset(document.getElementById(e).value,t,i,0)}handleBrickConditions(),document.getElementsByClassName("c4g__spinner-wrapper")[0]&&(document.getElementsByClassName("c4g__spinner-wrapper")[0].style.display="none")}}function changeCapacity(t,i){callFromChangeCapacity=!0,document.getElementsByClassName("reservation-id")[0]&&(document.getElementsByClassName("reservation-id")[0].style.display="none");var n=!1,a=!1,r=document.getElementById("c4g_reservation_type");if(r){t=r.value||-1;r=r.options[r.selectedIndex];if(r&&(n=2==r.getAttribute("type"),a=3==r.getAttribute("type")),0<t){var r=document.getElementById("c4g_desiredCapacity_"+t),r=(r&&(e=r.value,r.getAttribute("max")&&e>parseInt(r.getAttribute("max"))&&(r.value=r.getAttribute("max")),r.getAttribute("min"))&&e<parseInt(r.getAttribute("min"))&&(r.value=r.getAttribute("min")),document.getElementById("c4g_duration_"+t)),e=(r&&"none"!==r.style.display&&(r.style.display="block",e=r.value,r&&r.getAttribute("max")&&e>parseInt(r.getAttribute("max"))&&(r.value=r.getAttribute("max")),r)&&r.getAttribute("min")&&e<parseInt(r.getAttribute("min"))&&(r.value=r.getAttribute("min")),"c4g_beginDate_"+t);if(a){r=document.getElementById("c4g_reservation_object_"+t);r&&(e=e+"-33"+r.value,document.getElementById(e))&&setTimeset(document.getElementById(e).value,t,i,r.value)}else if(n){var a=window.location.search;let e=new URLSearchParams(a).get("event");if(e||-1!==(a=(r=window.location.pathname.split("/")).indexOf("event"))&&r[a+1]&&(e=r[a+1].replace(".html","")),e){r=document.getElementById("c4g_reservation_object_event_"+t),a=(r&&(r.value=e),"c4g_beginDateEvent_"+t+"-22"+e);document.getElementById(a)&&(setTimeset(document.getElementById(a).value,t,i,0),checkEventFields())}else{var l=document.getElementsByClassName("c4g__form-date-input");if(l)for(var s=0;s<l.length;s++){var d=l[s];if(d&&checkType(d,n)&&d.value){var o=d.id;if(o&&-1!==o.indexOf("c4g_beginDateEvent_"+t+"-22")){setTimeset(d.value,t,i,0),checkEventFields();break}}}}}else document.getElementById(e)&&setTimeset(document.getElementById(e).value,t,i,0)}handleBrickConditions(),document.getElementsByClassName("c4g__spinner-wrapper")[0]&&(document.getElementsByClassName("c4g__spinner-wrapper")[0].style.display="none")}}function checkTimelist(n,a){var r=-1;if(n&&a)for(idx=0;idx<a.length;idx++){let i=0;if(a[idx]){let e=[];var l=a[idx].toString();l&&l.indexOf("#")?e=l.split("#"):e[0]=l;let t=[];if((n=n.toString()).indexOf("#")?t=n.split("#"):t[0]=n,parseInt(e[0])===parseInt(t[0])&&(r=idx,i++),e[1]&&t[1]){var l=parseInt(e[0]),s=l+parseInt(e[1]),d=parseInt(t[0]),o=d+parseInt(t[1]);if(l<=d&&d<s&&(r=idx,i++),l<o&&o<=s&&(r=idx,i++),3==i)break}else if(e[1]&&t[0]){d=parseInt(e[0]),l=d+parseInt(e[1]),o=parseInt(t[0]);if(d<=o&&o<=l&&(r=idx,i++),3==i)break}else if(e[0]&&t[1]){var s=parseInt(e[0]),l=parseInt(t[0]),c=l+parseInt(t[1]);if(l<=s&&s<=c&&(r=idx,i++),3==i)break}}else if(1==i)break}return r}function checkMax(n,a,r,l,s,e){let d=!0;e=n[a][r].act+parseInt(e);if(n[a][r].max&&e<=n[a][r].max){for(y=0;y<n.length;y++)if(l&&s&&y!=a){let e=[];var o,c,u,m=s[y].toString();m&&m.indexOf("#")?e=m.split("#"):e[0]=m;let t=[],i=((l=l.toString()).indexOf("#")?t=l.split("#"):t[0]=l,!1);if(i=parseInt(e[0])===parseInt(t[0])||e[1]&&t[1]&&(o=(m=parseInt(e[0]))+parseInt(e[1]),u=(c=parseInt(t[0]))+parseInt(t[1]),m<=c&&c<o||m<u&&u<=o)?!0:i)for(z=0;z<n[y].length;z++)if(n[y][z].max&&n[y][z].act>=n[y][z].max||n[y][z].act+n[a][r].act>=n[a][r].max)return!1;d=!0}}else d=!n[a][r].max;return d}function shuffle(e){let t=e.length;for(;0<t;){var i=Math.floor(Math.random()*t),n=e[--t];e[t]=e[i],e[i]=n}return e}function addRadioFieldSet(h,e,A,I,E,B){if(e&&e.times){var N=e.times;if(h)for(;h.firstChild;)h.firstChild.remove();Object.keys(N).sort((e,t)=>e.split("#")[0]-t.split("#")[0]).forEach(function(e){var t=N[e].name,n=N[e].interval,a=N[e].time,r=N[e].objects,l=N[e].begin,e=N[e].description,s=0,d=document.getElementById("c4g_reservation_object_"+A),o="",c=1,u=0;if(d)for(i=0;i<d.options.length;i++){var m=d.options[i],g=m.getAttribute("min")?parseInt(m.getAttribute("min")):1,g=((-1==g||g<c)&&(c=g),m.getAttribute("max")?parseInt(m.getAttribute("max")):0);(-1==g||u<g)&&(u=g)}var v=[];let p="";if(!I||-1==I||c<=I&&(!u||I<=u)){var r=shuffle(r),b=!0;for(j=0;j<r.length;j++){var _=r[j];-1!=parseInt(_.id)&&(s=_.percent,_.priority&&1==_.priority?v.splice(0,0,_.id):v.push(_.id),b=!1)}o=b}else o=!0;for(j=0;j<v.length;j++)0==j?p+=v[j]:p=p+"-"+v[j];var y=document.createElement("div"),f=(y.className="c4g__form-check",document.createElement("input")),a=(f.type="radio",f.className="c4g__form-check-input c4g__btn-check",B?(f.setAttribute("name","_c4g_beginTime_"+A+"-33"+B),f.id="beginTime_"+A+"-33"+B+"-"+a+"#"+n,f.setAttribute("onclick","document.getElementById('c4g_beginTime_"+A+"-33"+B+"').value=this.value;")):(f.setAttribute("name","_c4g_beginTime_"+A),f.id="beginTime_"+A+"-"+a+"#"+n,f.setAttribute("onchange","setObjectId(this,"+A+","+E+");"),f.setAttribute("onclick","document.getElementById('c4g_beginTime_"+A+"').value=this.value;")),f.setAttribute("data-object",p),f.setAttribute("value",a+"#"+n),f.setAttribute("data-stamp",l),f.setAttribute("data-desc",e),f.style="display: block;",o&&(f.setAttribute("disabled",o),f.setAttribute("hidden",o)),0<s&&(f.className=f.className+" radio_object_hurry_up"),y.appendChild(f),document.createElement("label"));a.className="c4g__form-check-label c4g__btn c4g__btn-radio",a.innerText=t,a.htmlFor=f.id,y.appendChild(a),h.appendChild(y),h.parentNode.parentNode.getElementsByClassName("c4g__form-description")[0].innerText=e})}}function setTimeset(e,c,u,m){var t=-1,g=-1,n=document.querySelectorAll(".c4g__form-date-container .c4g_beginDate_"+c);if(n)for(k=0;k<n.length;k++){var a=n[k];a&&a.removeAttribute("data-org")}var r=document.getElementById("c4g_reservation_object_"+c);if(m)for(r.setAttribute("value",m),i=0;i<r.options.length;i++){var l=r.options[i];l.value==r.value?l.setAttribute("selected","true"):l.removeAttribute("selected")}else r&&(r.value=-1,eventFire(r,"change"));var v,s=document.getElementById("c4g_duration_"+c),s=(s&&s.style&&"none"!==s.display&&(t=s.value),document.getElementById("c4g_desiredCapacity_"+c));s&&s.style&&"none"!==s.display&&(g=s.value),(e=e&&e.indexOf("/")?(e=e.replace("/","~")).replace("/","~"):e)&&c&&(t=t||-1,g=g||-1,v=!(document.getElementsByClassName("c4g__spinner-wrapper")[0].style.display="flex"),fetch("/reservation-api/currentTimeset/"+e+"/"+c+"/"+t+"/"+g+"/"+m).then(e=>e.json()).then(e=>{var t=c;m&&(t+="-33"+m);addRadioFieldSet(document.querySelector(".radio-group-beginTime_"+t),e,c,g,u,m);var i=document.getElementById("c4g_reservation_object_"+c),n=e.captions;document.getElementById("c4g_reservation_id").value&&document.getElementById("c4g_reservation_id").value==e.reservationId||(document.getElementById("c4g_reservation_id").value=e.reservationId),document.getElementsByClassName("reservation-id")[0].style.display="block",document.getElementsByClassName("reservation_time_button_"+t);if(n&&n[m]){var a=document.getElementById("c4g_reservation_object_"+c);if(a&&a.length)for(z=0;z<a.options.length;z++)if(a.options[z].value==m){a.options[z].innerHtml=n[m];break}}if(handleBrickConditions(),-1!=c){var r=document.querySelectorAll(".radio-group-beginTime_"+t+' input[type = "hidden"]'),l=!1;if(r)for(z=0;z<r.length;z++)if("none"!=r[z].style.display){l=r[z].value;break}var s=document.querySelectorAll(".radio-group-beginTime_"+t+' input[type = "radio"]'),d=[];if(s&&s.length)for(z=0;z<s.length;z++){var o=s[z];!o||o.getAttribute("disabled")||o.getAttribute("hidden")||(l&&o.value===l?v=o:o.value&&d.push(o))}if(!v&&d&&1<=d.length)for(z=0;z<d.length;z++){v=d[z];break}if(!m&&i&&(setObjectId(0,c,u),i.value=-1,eventFire(i,"change"),i.disabled=!0),m)!v||v.disabled||v.classList.contains("radio_object_disabled")||v.click();else if(!v||v.disabled||v.classList.contains("radio_object_disabled")){for(z=0;z<d.length;z++)d[z].removeAttribute("checked");i&&(i.value=-1,eventFire(i,"change"),i.disabled=!0)}else v.setAttribute("checked","checked"),document.getElementById("c4g_beginTime_"+c).value=v.value,setObjectId(v,c,u)}}).finally(function(){document.getElementsByClassName("c4g__spinner-wrapper")[0].style.display="none"}))}function checkEventFields(){var e=document.getElementById("c4g_reservation_type"),t=e?e.value:-1,n=document.querySelectorAll("#c4g_reservation_object_event_"+t)[0],e=document.getElementsByClassName("eventdata");if(e&&(e.hidden=!0),n&&"hidden"!=n){for(i=0;i<n.length;i++)if(n[i].value){var a,r,l,s=-1;if(n[i].value&&(s=t.toString()+"-22"+n[i].value.toString(),a=document.querySelectorAll(".eventdata_"+s))&&(a.visibility="hidden",a.hidden=!0),r=document.getElementsByClassName("begindate-event"))for(j=0;j<r.length;j++)-1!=s&&r[j].querySelectorAll(".c4g__form-date-container")[j].childNodes[j].classList.contains("c4g_beginDateEvent_"+s)?(r[j].visible=!0,r[j].childNodes[j].getElementsByTagName("label").visible=!0,r[j].childNodes[j].querySelectorAll(".c4g__form-date-container").visible=!0,r[j].childNodes[j].getElementsByTagName("input").visible=!0):(r[j].hidden=!0,r[j].getElementsByTagName("label").hidden=!0,r[j].childNodes[j].querySelectorAll(".c4g__form-date-container").hidden=!0,r[j].childNodes[j].getElementsByTagName("input").hidden=!0);if(l=document.getElementsByClassName("reservation_time_event_button"))for(j=0;j<l.length;j++)-1!=s&&l[j].classList.contains("reservation_time_event_button_"+s)?(l[j].visible=!0,l[j].childNodes[j].getElementsByTagName("label").visible=!0,l[j].parentNode.visible=!0,l[j].parentNode.parentNode.visible=!0,l[j].parentNode.parentNode.parentNode.visible=!0):(l[j].hidden=!0,l[j].childNodes[j].getElementsByTagName("label").hidden=!0,l[j].parentNode.hidden=!0,l[j].parentNode.parentNode.hidden=!0,l[j].parentNode.parentNode.parentNode.hidden=!0)}}else{if((r=document.getElementsByClassName("begindate-event"))&&Array.isArray(r))for(i=0;i<r.length;i++)r[i].hidden=!0;if((l=document.getElementsByClassName("reservation_time_event_button"))&&Array.isArray(l))for(i=0;i<l.length;i++)l[i].hidden=!0}}